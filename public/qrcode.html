<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
<img id="qrcode" src="data:image/png;base64,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" alt="">
<div id="status-div"></div>
<script>
  const status = {
    0: '未授权',
    1: '已授权',
    2: '超时'
  }
  const qrcode = document.getElementById('qrcode')
  const statusDiv = document.getElementById('status-div')
  let userId = null
  statusDiv.innerText = status[0]
  fetch('/qrcode').then(res => res.json()).then(res => {
    // qrcode.src = res.code //获取二维码
    qrcode.src = 'data:image/png;base64,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'//获取二维码
    userId = res.userId //获取用户id
    let timer = setInterval(() => {
      //轮询调用检查接口
      fetch(`/check/${userId}`).then(res => res.json()).then(res => {
        statusDiv.innerText = status[res.status]
        //如果返回的状态是 超时 或者是已授权 就停止轮训
        if (res.status != 0) {
          clearInterval(timer)
        }
      })
    }, 1000)
  })

</script>
</body>

</html>
